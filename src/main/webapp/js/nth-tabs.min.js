(function(d){d.fn.nthTabs=function(k){var c=this,l={allowClose:true,active:true,location:true,fadeIn:true,rollWidth:c.width()-120},f=d.extend({},l,k),j=0,e={getAllTabWidth:function(){var a=0;c.find(".nav-tabs li").each(function(){a+=parseFloat(d(this).width())});return a},getMarginStep:function(){return f.rollWidth/2},getActiveId:function(){return c.find('li[class="active"]').find("a").attr("href").replace("#","")},getTabList:function(){var a=[];c.find(".nav-tabs li a").each(function(){a.push({id:d(this).attr("href"),
title:d(this).children("span").html()})});return a},addTab:function(a){var b=[],g=a.active==undefined?f.active:a.active,h=a.allowClose==undefined?f.allowClose:a.allowClose,i=a.location==undefined?f.location:a.location,m=a.fadeIn==undefined?f.fadeIn:a.fadeIn,n=a.url==undefined?"":a.url;b.push('<li title="'+a.title+'">');b.push('<a href="#'+a.id+'" data-toggle="tab">');b.push("<span>"+a.title+"</span>");b.push("</a>");h&&b.push('<i class="icon nth-icon-close-mini tab-close"></i>');b.push("</li>");c.find(".nav-tabs").append(b.join(""));
b=[];b.push('<div class="tab-pane '+(m?"animation-fade":"")+'" id="'+a.id+'">');if(n.length>0){b.push('<iframe src="'+a.url+'" frameborder="0" name="iframe-'+j+'" class="nth-tabs-frame"></iframe>');j++}else b.push('<div class="nth-tabs-content">'+a.content+"</div>");b.push("</div>");c.find(".tab-content").append(b.join(""));g&&this.setActTab(a.id);i&&this.locationTab(a.id);return this},addTabs:function(a){for(var b in a)this.addTab(a[b]);return this},locationTab:function(a){a=a==undefined?e.getActiveId():
a;a=a.indexOf("#")>-1?a:"#"+a;a=c.find("[href='"+a+"']");var b=0;a.parent().prevAll().each(function(){b+=d(this).width()});a=a.parent().parent().parent();margin_left_total=b<=f.rollWidth?40:40-Math.floor(b/f.rollWidth)*f.rollWidth;a.css("margin-left",margin_left_total);return this},delTab:function(a){a=a==undefined?e.getActiveId():a;a=a.indexOf("#")>-1?a:"#"+a;var b=c.find("[href='"+a+"']");if(b.parent().attr("class")=="active"){var g=b.parent().next(),h=d(a).next();if(g.length<1){g=b.parent().prev();
h=d(a).prev()}g.addClass("active");h.addClass("active")}b.parent().remove();d(a).remove();return this},delOtherTab:function(){c.find(".nav-tabs li").not('[class="active"]').remove();c.find(".tab-content div.tab-pane").not('[class$="active"]').remove();c.find(".content-tabs-container").css("margin-left",40);return this},delAllTab:function(){c.find(".nav-tabs li").remove();c.find(".tab-content div").remove();return this},setActTab:function(a){a=a==undefined?e.getActiveId():a;a=a.indexOf("#")>-1?a:"#"+
a;c.find(".active").removeClass("active");c.find("[href='"+a+"']").parent().addClass("active");c.find(a).addClass("active");return this},toggleTab:function(a){this.setActTab(a).locationTab(a);return this},isExistsTab:function(a){a=a.indexOf("#")>-1?a:"#"+a;return c.find(a).length>0}},o={onWindowsResize:function(){d(window).resize(function(){f.rollWidth=c.width()-120});return this},onLocationTab:function(){c.on("click",".tab-location",function(){e.locationTab()});return this},onTabClose:function(){c.on("click",
".tab-close",function(){var a=d(this).parent().find("a").attr("href"),b=c.find("[href='"+a+"']");if(b.parent().next().length==0){var g=0;b.parent().prevAll().each(function(){g+=d(this).width()});var h=b.parent().width(),i=40;b=b.parent().parent().parent();if(g>f.rollWidth){i=b.css("marginLeft").replace("px","");i=parseFloat(i)+h+40}b.css("margin-left",i)}e.delTab(a)});return this},onTabCloseOpt:function(){c.on("click",".tab-close-current",function(){e.delTab()});return this},onTabCloseOther:function(){c.on("click",
".tab-close-other",function(){e.delOtherTab()});return this},onTabCloseAll:function(){c.on("click",".tab-close-all",function(){e.delAllTab()});return this},onTabRollLeft:function(){c.on("click",".roll-nav-left",function(){var a=d(this).parent().find(".content-tabs-container"),b;if(e.getAllTabWidth()<=f.rollWidth)b=40;else{b=a.css("marginLeft").replace("px","");b=parseFloat(b)+e.getMarginStep()+40}a.css("margin-left",b>40?40:b)});return this},onTabRollRight:function(){c.on("click",".roll-nav-right",
function(){if(e.getAllTabWidth()<=f.rollWidth)return false;var a=d(this).parent().find(".content-tabs-container"),b=a.css("marginLeft").replace("px",""),g=parseFloat(b)-e.getMarginStep();if(e.getAllTabWidth()-Math.abs(b)<=f.rollWidth)return false;a.css("margin-left",g)});return this},onTabList:function(){c.on("click",".right-nav-list",function(){var a=e.getTabList(),b=[];d.each(a,function(g,h){b.push('<li class="toggle-tab" data-id="'+h.id+'">'+h.title+"</li>")});c.find(".tab-list").html(b.join(""))});
c.find(".tab-list-scrollbar").scrollbar();this.onTabListToggle();return this},onTabListToggle:function(){c.on("click",".toggle-tab",function(){var a=d(this).data("id");e.setActTab(a).locationTab(a)});return this}};return function(){c.html('<div class="page-tabs"><a href="#" class="roll-nav roll-nav-left"><span class="fa fa-angle-double-left"></span></a><div class="content-tabs"><div class="content-tabs-container"><ul class="nav nav-tabs"></ul></div></div><a href="#" class="roll-nav roll-nav-right"><span class="fa fa-angle-double-right"></span></a><div class="dropdown roll-nav right-nav-list"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="tab-down"></span></a><ul class="dropdown-menu"><li><a href="#" class="tab-location">\u5b9a\u4f4d\u5f53\u524d\u9009\u9879\u5361</a></li><li><a href="#" class="tab-close-current">\u5173\u95ed\u5f53\u524d\u9009\u9879\u5361</a></li><li role="separator" class="divider"></li><li><a href="#" class="tab-close-other">\u5173\u95ed\u5176\u4ed6\u9009\u9879\u5361</a></li><li><a href="#" class="tab-close-all">\u5173\u95ed\u5168\u90e8\u9009\u9879\u5361</a></li><li class="divider"></li><li class="scrollbar-outer tab-list-scrollbar"><div class="tab-list-container"><ul class="tab-list"></ul></div></li></ul></div></div><div class="tab-content"></div>');
o.onWindowsResize().onTabClose().onTabRollLeft().onTabRollRight().onTabList().onTabCloseOpt().onTabCloseAll().onTabCloseOther().onLocationTab();return e}()}})(jQuery);
